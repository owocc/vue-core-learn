{"version":3,"file":"vue.js","sources":["../src/observer/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["// å¯¹æ•°æ®è¿›è¡ŒåŠ«æŒ\n\n/* Note:\n    dataä¸­çš„æ•°æ®å¯èƒ½æ˜¯ä¸€ä¸ª æ™®é€šçš„å¯¹è±¡çš„å€¼:           {name:'owo'}\n    ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ä¸­çš„å¯¹è±¡:                       {user:{age:12}}\n    æˆ–è€…ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„æ•°ç»„ä¹Ÿå¯èƒ½æ˜¯æ•°ç»„ä¸­åµŒå¥—      {[1,2,3]} || {[{age:12},{age:14},{age:15}]}\n    å½“ç„¶æ•°æ®ä¹Ÿå¯èƒ½æ›´å¤æ‚,å°±æ˜¯ä¸€è·¯åµŒå¥—è¿›å»\n    è¿™é‡Œçš„æœ€å¤–å±‚çš„ {} éƒ½æ˜¯æŒ‡ data è¿”å›çš„é‚£ä¸ªå¯¹è±¡(( \n*/\n\nexport function observer(data) {\n    // è¿™é‡Œè¦åˆ¤æ–­æ•°æ®æ˜¯å¦ä¸æ˜¯ object\n    if (typeof data != 'object' || data == null) {\n        return data\n    }\n    // å¤„ç†å¯¹è±¡çš„æ•°æ®åŠ«æŒ\n    return new Observer(data)\n}\n\n// å¯¹æ•°æ®è¿›è¡ŒåŠ«æŒ\n// Observer è§‚å¯Ÿè€…\n// åœ¨ vue2 ä¸­æ˜¯ä½¿ç”¨ Object.defineProperty æ¥å¯¹æ•°æ®è¿›è¡ŒåŠ«æŒçš„,å®ƒæœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯åªèƒ½å¯¹å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§è¿›è¡ŒåŠ«æŒ(æ‰€ä»¥éœ€è¦ä½¿ç”¨é€’å½’æ¥è¿›è¡Œæ•°æ®çš„åŠ«æŒ)\nclass Observer {\n    constructor(value) {\n        this.walk(value)\n    }\n    walk(data) {\n        let keys = Object.keys(data) // è·å–åˆ°å¯¹è±¡çš„æ‰€æœ‰ key,æ–¹ä¾¿ç­‰ä¸‹ç”¨ Object.defineProperty æ¥è®¾ç½®ä»£ç†\n        // é€šè¿‡å¾ªç¯è®¾ç½®æ•°æ®åŠ«æŒ \n        for (let i = 0; i < keys.length; i++) {\n            let key = keys[i] // å¾—åˆ°å¯¹è±¡ä¸­çš„ä¸€ä¸ªé”®\n            let value = data[key] // value è¡¨ç¤ºä¼ å…¥çš„ data å¯¹è±¡å¯¹åº”çš„å€¼(å’Œkeyå¯¹åº”)\n            defineReactive(data,key,value)\n        }\n    }\n}\n/**\n * å¯¹å¯¹è±¡ä¸­çš„å±æ€§è¿›è¡ŒåŠ«æŒ\n * @param {*} data éœ€è¦è¿›è¡Œæ•°æ®åŠ«æŒçš„å¯¹è±¡\n * @param {*} key éœ€è¦åŠ«æŒçš„é”®\n * @param {*} value æ•°æ®çš„å€¼\n */\nfunction defineReactive(data,key,value){\n    // åœ¨è¿™ä¸ªåœ°æ–¹å°±è¦è¿›è¡Œé€’é¾ŸğŸ¢,ä¸ºäº†è®©æ›´æ·±å±‚çš„æ•°æ®ä¹Ÿè¢«ä»£ç†\n    // å› ä¸ºåœ¨è¿™é‡Œçš„æ—¶å€™æ•°æ®å¯èƒ½é•¿è¿™æ ·: dataæ•°æ®:{user:{age:1,sex:{man:1,woman:1}}}\n    observer(value) // å¯¹æ•°æ®è¿›è¡Œæ·±åº¦ç›‘å¬((æ•°æ®ç‰¹åˆ«å¤šçš„è¯,å†…å­˜è¡¨ç¤ºä½ è¡Œ,ç»™ä½ å¤§æ‹‡å“¥ğŸ‘\n    Object.defineProperty(data,key,{\n        get(){\n            console.log('è·å–',key);\n            return value\n        },\n        //set æ–¹æ³•æ¥æ”¶åˆ°çš„å°±æ˜¯æ–°è®¾ç½®çš„å€¼\n        set(newValue){\n            // åˆ¤æ–­æ–°è®¾ç½®çš„å€¼æ˜¯å¦å’Œå½“å‰çš„å€¼ä¸€è‡´,å¦‚æœä¸€è‡´ç›´æ¥è¿”å›\n            if(newValue === value) return\n            // å¦‚æœä¸ä¸€è‡´,å°±æ›´æ–°\n            // ä¸è¿‡åœ¨ä¿®æ”¹å‰ä¹Ÿå¾—ä¸ºæ•°æ®è®¾ç½®ä¸€ä¸‹å“åº”å¼~å› ä¸ºä¼ å…¥çš„å€¼å¯èƒ½æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡\n            observer(newValue)\n            value = newValue\n        }\n    })\n}","import { observer } from \"./observer/index\"\n\n// åˆå§‹åŒ–çŠ¶æ€\nexport function initState(vm) {\n    let opts = vm.$options\n    // åˆ¤æ–­ä¼ å…¥äº†å“ªäº›å±æ€§\n    if (opts.props) {\n        initProps()\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n    if (opts.watch) {\n        initWatch()\n    }\n    if (opts.computed) {\n        initComputed()\n    }\n    if (opts.methods) {\n        initMethods()\n    }\n}\n\nfunction initProps() { }\n\nfunction initWatch() { }\nfunction initComputed() { }\nfunction initMethods() { }\n\n// å¯¹ Data è¿›è¡Œåˆå§‹åŒ–\nfunction initData(vm) {\n    let data = vm.$options.data\n    // åˆ¤æ–­ data æ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•°,å¦‚æœæ˜¯ä¸€ä¸ªå‡½æ•°å°±å°†å®ƒæ‰§è¡Œ,å¦‚æœä¸æ˜¯å°±è¿”å› data åŸæœ‰çš„å€¼\n    // è¿™é‡Œéœ€è¦ä¿®æ”¹ä¸‹ this çš„æŒ‡å‘\n    data = vm._data = typeof data == \"function\" ? data.call(vm) : data\n    // --- å¯¹ data æ•°æ®è¿›è¡ŒåŠ«æŒ ---\n    observer(data)\n}","import { initState } from \"./initState\"\n\n// åˆå§‹åŒ– Vue\nexport function initMixin(Vue) {\n\n    // ä¸º Vue çš„åŸå‹é“¾æ·»åŠ  _init æ–¹æ³•\n    Vue.prototype._init = function (options) {\n        console.log(options)\n        let vm = this // åˆ›å»ºä¸€ä¸ªå¿«æ·çš„å˜é‡æŒ‡å‘å½“å‰ Vue å®ä¾‹\n        vm.$options = options // ç»‘å®šå¿«æ·å˜é‡,æ–¹ä¾¿åé¢è®¿é—®\n        initState(vm) // å°†å½“å‰çš„ Vue å®ä¾‹ä¼ é€’ç»™åˆå§‹åŒ–çŠ¶æ€\n    }\n}\n\n","import { initMixin } from \"./init\"\n\n/**\n * \n * @param {*} options Vueçš„é€‰é¡¹ æ¯”å¦‚ props | data | watch ...ç­‰ç­‰\n */\nfunction Vue(options){\n    this._init(options)\n}\ninitMixin(Vue) // åˆå§‹åŒ– Vue\nexport default Vue"],"names":["observer","data","_typeof","Observer","value","_classCallCheck","walk","_createClass","key","keys","Object","i","length","defineReactive","defineProperty","get","console","log","set","newValue","initState","vm","opts","$options","props","initData","watch","computed","methods","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":"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"}